---
title: "RF24: Usuario selecciona plantilla."  
sidebar_position: 25
---

# RF24: Usuario selecciona plantilla de reporte.

**Última actualización:** 08 de marzo de 2025

### Historia de Usuario

Yo como usuario quiero seleccionar una plantilla de reporte para generar un informe en formato de PDF.

  **Criterios de Aceptación:**
  - El usuario debe de poder seleccionar una plantilla de la lista
  - La plantilla seleccionada debe de aplicarse automaticamente. 

---

### Diagrama de Secuencia
El diagrama de secuencia está separado en dos partes para facilitar la visualización. La mitad de arriba corresponde a la aplicación de Electron y la otra mitad al servidor desacoplado.

Primera parte (Electron)
``` mermaid

sequenceDiagram
    actor Usuario
    participant Vista
    participant RutaElectron as Ruta(Electron)
    participant ControladorElectron as Controlador(Electron)
    participant Caso as CasoSeleccionarPlantilla
    participant RepositorioElectron as Repositorio(Electron)
    participant API

    Usuario->>Vista: Selecciona una plantilla del listado
    Vista->>RutaElectron: GET /plantillasReportes/{IdPlantilla}
    RutaElectron->>ControladorElectron: getReportePlantilla(IdPlantilla)
    ControladorElectron->>Caso: getReportePlantilla(IdPlantilla)
    Caso->>RepositorioElectron: getReportePlantilla(IdPlantilla)
    RepositorioElectron->>API: getReportePlantilla(IdPlantilla)

    alt Caso exitoso
        rect Lightgreen
            API ->> RepositorioElectron: Regresa información de la plantilla
            RepositorioElectron ->> Caso: Regresa información de la plantilla
            Caso ->> ControladorElectron: Regresa información de la plantilla
            ControladorElectron ->> Vista: Crea el reporte basado en la información de la plantilla
            Vista->>Usuario: Visualiza el reporte seleccionado
        end
    else Plantilla no encontrada
        rect rgb(255, 77, 77)
            API ->> RepositorioElectron: Error 404: No se encontró la plantilla
            RepositorioElectron ->> Caso: Error 404: No se encontró la plantilla
            Caso ->> ControladorElectron: Error 404: No se encontró la plantilla
            ControladorElectron ->> Vista: Error 404: No se encontró la plantilla
            Vista->>Usuario: Mensaje de error: Plantilla no encontrada
        end
    else Falla en el repositorio
        rect rgb(255, 77, 77)
            API ->> RepositorioElectron: Error 500: Fallo en repositorio
            RepositorioElectron ->> Caso: Error 500: Fallo en repositorio
            Caso ->> ControladorElectron: Error 500: Fallo en repositorio
            ControladorElectron ->> Vista: Error 500: Fallo en repositorio
            Vista->>Usuario: Mensaje de error: Fallo en repositorio
        end
    else Falla en el controlador
        rect rgb(255, 77, 77)
            API ->> RepositorioElectron: Error 500: Fallo interno del servidor
            RepositorioElectron ->> Caso: Error 500: Fallo interno del servidor
            Caso ->> ControladorElectron: Error 500: Fallo interno del servidor
            ControladorElectron ->> Vista: Error 500: Fallo interno del servidor
            Vista->>Usuario: Mensaje de error: Fallo en el servidor
        end
    end
```
Segunda parte (Servidor desacoplado)
```mermaid

sequenceDiagram
    participant API
    participant Ruta as Ruta(Servidor)
    participant Controlador as Controlador(Servidor)
    participant Repositorio as Repositorio(Servidor)
    participant Modelo

    API->>Ruta: getReportePlantilla(IdPlantilla)
    Ruta->>Controlador: getReportePlantilla(IdPlantilla)
    Controlador->>Repositorio: getReportePlantilla(IdPlantilla)
    Repositorio->>Modelo: findById(IdPlantilla)

    alt Caso exitoso
        rect Lightgreen
            Modelo ->> Repositorio: Regresa información de la plantilla
            Repositorio ->> Controlador: Regresa información de la plantilla
            Controlador ->> Ruta: Regresa información de la plantilla
            Ruta ->> API: Regresa información de la plantilla
        end
    else Plantilla no encontrada
        rect rgb(255, 77, 77)
            Modelo ->> Repositorio: Error: Plantilla no encontrada
            Repositorio ->> Controlador: Error: Plantilla no encontrada
            Controlador ->> Ruta: Error 404: No se encontró la plantilla
            Ruta ->> API: Error 404: No se encontró la plantilla
        end
    else Falla en el repositorio
        rect rgb(255, 77, 77)
            Repositorio --x Controlador: Error 500: Base de datos inaccesible
            Controlador ->> Ruta: Error 500: Fallo en repositorio
            Ruta ->> API: Error 500: Fallo en repositorio
        end
    else Falla en el controlador
        rect rgb(255, 77, 77)
            Controlador --x Ruta: Error 500: Fallo interno en el procesamiento
            Ruta ->> API: Error 500: Fallo interno del servidor
        end
    end
```

> *Descripción*: El diagrama de secuencia muestra cómo el usuario selecciona una plantilla y esta se aplica automaticamente.

### Mockup

![Mockup]

> *Descripción*: El mockup representa la interfaz donde el usuario selecciona y aplica una plantilla de reporte. 

---

### Pruebas Unitarias 
| ID Prueba | Descripción | Resultado Esperado |
|-----------|-------------|--------------------|
|PU-RF24-01|Seleccionar una plantilla.|La plantilla se aplica correctamente al reporte.|
|PU-RF24-02|Verificar datos.|El reporte muestra la configuración de la plantilla guardada previamente|

| Autor | Descripción del cambio | Versión |
|---------|-------------------------|---------|
| Daniel Queijeiro Albo | Agregar diagrama de secuencia | V.1.1 |