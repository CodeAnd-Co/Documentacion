---
title: "RF74: Usuario aplica fórmula."  
sidebar_position: 75
---

# RF74: Usuario aplica fórmula

**Última actualización:** 27 de marzo de 2025

### Historia de Usuario

Yo como usuario quiero poder aplicar las fórmulas que previamente fueron definidas para poder generar datos complejos o filtrar los datos que usaré en la generación de reportes.

  **Criterios de Aceptación:**
  - El sistema debe permitir seleccionar una fórmula previamente guardada.
  - El sistema debe aplicar la fórmula sobre los datos seleccionados.
  - El usuario debe poder ver el resultado aplicado en una tabla o gráfica.
  - Si la fórmula tiene un error de sintaxis o usa datos no disponibles, el sistema debe notificarlo visualmente.
---

### Diagrama de Secuencia

![Diagrama de Secuencia] 

> *Descripción*: El diagrama de secuencia muestra cómo el usuario interactúa con el sistema para visualizar la página de incio de sesión, detallando los pasos de solicitud de datos, validación y confirmación.

```mermaid
sequenceDiagram
    actor Usuario
    participant Vista
    participant Ruta
    participant Controlador
    participant ConsultarFormulas
    participant AplicarFormula
    participant Repositorio
    participant Modelo

    %% Consulta de fórmulas
    Usuario ->> Vista: Seleccionó datos a comparar exitósamente
    Vista ->> Ruta: consultarFormulas()
    Ruta ->> Controlador: consultarFormulas()
    Controlador ->> ConsultarFormulas: consultarFormulas()
    ConsultarFormulas ->> Repositorio: consultarFormulas()
    Repositorio ->> Modelo: consultarFormulas()
    Modelo -->> Repositorio: respuesta(listadoFormulas)
    Repositorio -->> ConsultarFormulas: respuesta(listadoFormulas)
    ConsultarFormulas -->> Controlador: respuesta(listadoFormulas)
    Controlador -->> Ruta: respuesta(listadoFormulas)
    Ruta -->> Vista: respuesta(listadoFormulas)
    Vista -->> Usuario: Mostrar listado de fórmulas

    %% Aplicación de fórmula
    Usuario ->> Vista: Selecciona fórmula a aplicar
    Vista ->> Ruta: aplicarFormula()
    Ruta ->> Controlador: aplicarFormula()
    Controlador ->> AplicarFormula: aplicarFormula(formula, datosSeleccionados)
    AplicarFormula ->> Repositorio: obtenerDatos(datosSeleccionados)
    Repositorio ->> Modelo: obtenerDatos(datosSeleccionados)
    alt Obtención exitosa de los datos seleccionados
        rect Lightgreen
        Modelo -->> Repositorio: respuesta(datos)
        Repositorio -->> AplicarFormula: respuesta(datos)
        AplicarFormula -->> Controlador: respuesta(datos complejos / filtrados)
        Controlador -->> Ruta: respuesta(datos complejos / filtrados)
        Ruta -->> Vista: respuesta(datos complejos / filtrados)
        Vista -->> Usuario: Mostrar datos complejos / filtrados
        end
    else Error en la obtención de los datos seleccionados
        rect Lightcoral
        Modelo -->> Repositorio: error("No se pudieron obtener los datos.")
        Repositorio -->> AplicarFormula: respuesta(error)
        AplicarFormula -->> Controlador: respuesta(error)
        Controlador -->> Ruta: respuesta(error)
        Ruta -->> Vista: respuesta(error)
        Vista -->> Usuario: Mostrar mensaje de error
        end
    end

```


---

### Mockup

![Mockup]

> *Descripción*: El mockup representa la interfaz del sistema donde el usuario puede consultar la página de inicio de sesión. 

---

### Pruebas Unitarias 
| ID Prueba | Descripción | Resultado Esperado |
|-----------|-------------|--------------------|
|PU-RF74-01|Pendiente | Pendiente|
|PU-RF74-02|Pendiente | Pendiente|

---

### Registro de cambios

| Autor | Descripción del cambio | Versión |
|---------|-------------------------|---------|
| Rommel Toledo Crespo | Definición y Criterios de Aceptación | 1.0 |