---
title: "RF26: Registrar la alimentación de la charola"  
sidebar_position: 26
---

# RF26: Registrar la alimentación de la charola

**Última actualización:** 14 de mayo de 2025

### Historia de Usuario
Como usuario, quiero registrar la alimentación que se le da a una charola, incluyendo el tipo de alimento y la cantidad. Para llevar un control detallado de la nutrición y el bienestar de las larvas y escarabajos.

  **Criterios de Aceptación:**
  - El sistema debe permitir ingresar el tipo y cantidad de alimento proporcionada.
  - La información ingresada debe actualizarse en el historial de la charola.
  - Solo los usuarios autorizados deben poder registrar alimentación.

---

### Diagrama de Secuencia

```mermaid
sequenceDiagram
    actor Usuario 
    participant View as View
    participant ViewModel as ViewModel
    participant Domain as Domain
    participant Repository as Repository
    participant APIService as API Service (MVVM)
    participant Controller as Controller
    participant Model as Model
    participant Database as Base de Datos

    %% --- FLUJO PRINCIPAL ---
    Usuario->>+View: Ingresa datos de alimentación
    View->>+ViewModel: alimentarCharola(datos)
    deactivate View
    ViewModel->>+Domain: alimentarCharola(datos)
    deactivate ViewModel
    Domain->>+Repository: alimentarCharola(datos)
    deactivate Domain
    Repository->>+APIService: POST /alimentarCharola(datos)
    deactivate Repository
    APIService->>+Controller: POST /alimentarCharola(datos)
    deactivate APIService
    Controller->>+Model: guardarAlimentacion(datos)
    deactivate Controller
    Model->>+Database: INSERT INTO alimentacion VALUES (...)
    deactivate Model
    activate Database
    Database-->>-Model: Éxito
    activate Model
    Model-->>-Controller: Confirmación
    activate Controller
    Controller-->>-APIService: 200 OK
    activate APIService
    APIService-->>-Repository: Alimentación registrada
    activate Repository
    Repository-->>-Domain: Éxito
    activate Domain
    Domain-->>-ViewModel: Alimentación exitosa
    activate ViewModel
    ViewModel-->>-View: Mostrar confirmación
    activate View
    View-->>Usuario: ✅ Alimentación registrada exitosamente

    %% --- CASO ALTERNO A: Datos inválidos ---
    alt Datos inválidos
        Usuario->>+View: Ingresa datos incorrectos (ej. sin peso)
        View->>+ViewModel: alimentarCharola(datos inválidos)
        deactivate View
        ViewModel->>+Domain: validarDatos()
        deactivate ViewModel
        Domain-->>-ViewModel: ❌ Validación fallida
        activate ViewModel
        ViewModel-->>-View: ⚠️ Datos inválidos (falta peso o fecha)
        activate View
        View-->>Usuario: Mostrar mensaje de error de validación
    end

    %% --- CASO ALTERNO B: Error de red o API ---
    alt Error de red o API
        Usuario->>+View: Ingresa datos válidos
        View->>+ViewModel: alimentarCharola(datos)
        deactivate View
        ViewModel->>+Domain: alimentarCharola(datos)
        deactivate ViewModel
        Domain->>+Repository: alimentarCharola(datos)
        deactivate Domain
        Repository->>+APIService: POST /alimentarCharola(datos)
        deactivate Repository
        APIService-->>-Repository: ❌ Error de red / 500
        activate Repository
        Repository-->>-Domain: Error de red/API
        activate Domain
        Domain-->>-ViewModel: Mostrar error
        activate ViewModel
        ViewModel-->>-View: ❌ No se pudo registrar alimentación
        activate View
        View-->>Usuario: Mostrar mensaje de error de conexión
    end

    %% --- CASO ALTERNO C: Error en base de datos ---
    alt Error en la base de datos
        Usuario->>+View: Ingresa datos válidos
        View->>+ViewModel: alimentarCharola(datos)
        deactivate View
        ViewModel->>+Domain: alimentarCharola(datos)
        deactivate ViewModel
        Domain->>+Repository: alimentarCharola(datos)
        deactivate Domain
        Repository->>+APIService: POST /alimentarCharola(datos)
        deactivate Repository
        APIService->>+Controller: POST /alimentarCharola(datos)
        deactivate APIService
        Controller->>+Model: guardarAlimentacion(datos)
        deactivate Controller
        Model->>+Database: INSERT INTO alimentacion VALUES (...)
        deactivate Model
        activate Database
        Database-->>-Model: ❌ Error SQL
        activate Model
        Model-->>-Controller: Error al guardar
        activate Controller
        Controller-->>-APIService: 500 Internal Server Error
        activate APIService
        APIService-->>-Repository: Error backend
        activate Repository
        Repository-->>-Domain: Fallo de almacenamiento
        activate Domain
        Domain-->>-ViewModel: Error
        activate ViewModel
        ViewModel-->>-View: ❌ Fallo al guardar datos
        activate View
        View-->>Usuario: Mostrar error interno
    end
```

> *Descripción*: El diagrama de secuencia muestra cómo los usuarios pueden ingresar alimentación a una charola.

---

### Mockup

![Mockup](./image-3.png)

> *Descripción*: El mockup muestra la interfaz donde el Super Administrador o Cliente pueden registrar la alimentación de una charola



### Pruebas Unitarias 
| ID Prueba  | Descripción                                               | Resultado Esperado  |
|------------|-----------------------------------------------------------|---------------------|
| PU-RF26-01 | Registrar alimentación de una charola con datos válidos.  | El sistema guarda correctamente la información y confirma el registro. |
| PU-RF26-02 | Verificar que la información ingresada se actualiza en el historial de la charola. | El sistema refleja los cambios en el historial sin necesidad de recarga. |
| PU-RF26-03 | Intentar registrar alimentación sin especificar tipo o cantidad. | El sistema muestra un mensaje de error indicando que los datos son obligatorios. |
| PU-RF26-04 | Validar que los registros de alimentación sean accesibles en consultas futuras. | La información almacenada puede ser consultada posteriormente sin inconsistencias. |
| PU-RF26-05 | Evaluar el tiempo de respuesta al registrar múltiples entradas de alimentación. | El sistema procesa correctamente la operación sin afectar el rendimiento. |


# Historial de cambios
| **Tipo de Versión** | **Descripción**                      | **Fecha**  | **Colaborador**   |
| ------------------- | ------------------------------------ | ---------- | ----------------- |
| **1.0**             | Creación de la historia de usuario   | 8/3/2025   | Armando Mendez    |
| **1.1**             | Diagrama de secuencia y mockup       | 14/05/2025 | Juan Eduardo      |
